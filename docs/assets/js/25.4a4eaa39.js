(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{293:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("こんにちは．12月に入り非常に寒い日々が続いています．個人的には10月から続いていたセキュリティキャンプが一段落して少し余裕が出てきました．\nまた，この記事は"),a("a",{attrs:{href:"https://adventar.org/calendars/5335",target:"_blank",rel:"noopener noreferrer"}},[s._v("SecHack365 Advent Calendar 2020"),a("OutboundLink")],1),s._v("の記事として書いています．\n今回は趣味で開発しているツールを紹介します．")]),s._v(" "),a("h1",{attrs:{id:"pyns2の紹介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pyns2の紹介"}},[s._v("#")]),s._v(" pyns2の紹介")]),s._v(" "),a("p",[s._v("pyns2という名前で開発しています．python + network simulator + network namespaceで名付けました．")]),s._v(" "),a("p",[s._v("リポジトリはこちら")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/terassyi/pyns2",target:"_blank",rel:"noopener noreferrer"}},[s._v("github.com/terassyi/pyns2"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("このツールはLinuxの標準機能として提供されているNamespaceの一つである"),a("code",[s._v("Network Namespace")]),s._v("を使用して一つのホスト内で仮想的にデバイスなどを分離して仮想ネットワークを作成するためのツールです．")]),s._v(" "),a("p",[a("code",[s._v("Network Namespace")]),s._v("を使用して仮想ネットワークを作成することで軽量かつ柔軟にネットワークを作ることができます．また，実際のソフトウェアやツールをその仮想ネットワーク上で動作させることができるのでイメージがつきやすいです．複数のコンテナでネットワークを作るのと比較してもイメージを用意しなくていいので簡単に動作させることができるようになっています．")]),s._v(" "),a("h2",{attrs:{id:"モチベーション"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#モチベーション"}},[s._v("#")]),s._v(" モチベーション")]),s._v(" "),a("p",[s._v("動機はネットワークの実験をする際に一つのホスト上で仮想ネットワークを作って実験することが多いのですが，毎回同一のネットワーク環境を構築するのが手間だったり設定覚えられなかったりするのでIaC的に管理できるといいなと思ったことです．")]),s._v(" "),a("h2",{attrs:{id:"linux-network-namespace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux-network-namespace"}},[s._v("#")]),s._v(" Linux Network Namespace")]),s._v(" "),a("p",[s._v("Linuxにはnamespaceという機能があり，これらの名前空間を分離することでプロセスがあたかも独立したリソースを持っているように振舞うことができるようになります．コンテナ仮想化はこの名前空間分離機能を用いて実現されています．詳しくは"),a("a",{attrs:{href:"https://linuxjm.osdn.jp/html/LDP_man-pages/man7/namespaces.7.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("namespaceのman"),a("OutboundLink")],1),s._v("を参照してください．\nNetwork Namespaceはその中の一つでネットワーク関連のシステムリソースの分離を実現します．\n簡単にNetwork Namespaceの機能を使用するには"),a("code",[s._v("ip netns")]),s._v("コマンドを使用します．\n詳しい使い方はこちら("),a("a",{attrs:{href:"https://qiita.com/hana_shin/items/ab078b5552f5df029030",target:"_blank",rel:"noopener noreferrer"}},[s._v("ip netnsコマンドの使い方（ネットワークの実験の幅が広がるなぁ～）"),a("OutboundLink")],1),s._v(")を参照してください．")]),s._v(" "),a("h2",{attrs:{id:"ip-netnsとpyns2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ip-netnsとpyns2"}},[s._v("#")]),s._v(" ip netnsとpyns2")]),s._v(" "),a("p",[a("code",[s._v("pyns2")]),s._v("で構築することのできる仮想ネットワークは"),a("code",[s._v("ip netns")]),s._v("コマンド(一部"),a("code",[s._v("iptables")]),s._v(")で実現することができます．\nシェルスクリプトを用意してあげるのももちろんありですがyamlで定義できる方が宣言的にリソースを定義できますし，削除など管理が楽になります．また，複雑なネットワークを構築することも簡単になります．")]),s._v(" "),a("h2",{attrs:{id:"動作環境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#動作環境"}},[s._v("#")]),s._v(" 動作環境")]),s._v(" "),a("p",[a("code",[s._v("pyns2")]),s._v("はLinux環境でのみ動作します．\nリポジトリに"),a("code",[s._v("Vagrantfile")]),s._v("と"),a("code",[s._v("Dockerfile")]),s._v(", "),a("code",[s._v("docker-compose.yml")]),s._v("を用意しているのでそちらを使用してください．")]),s._v(" "),a("p",[s._v("コンテナ環境上ではNATを使用した外部ネットワークへのアクセスは使用できませんがインターネットにアクセスできる仮想ネットワークを作成しない限りはDocker上での動作で十分だと思います．")]),s._v(" "),a("p",[s._v("詳しい使い方は"),a("a",{attrs:{href:"https://github.com/terassyi/pyns2/blob/master/README.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("README.md"),a("OutboundLink")],1),s._v("に記載しています．")]),s._v(" "),a("h2",{attrs:{id:"使ってみる"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使ってみる"}},[s._v("#")]),s._v(" 使ってみる")]),s._v(" "),a("p",[s._v("今回はVagrantを使用してVM上で仮想ネットワークを作成してみます．\nVagrantでVMを起動してVMに接続します．")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/terrasyi/pyns2\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" pyns2\n$ vagrant up\n$ vagrant "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# enter vm")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" pyns2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"定義ファイル"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定義ファイル"}},[s._v("#")]),s._v(" 定義ファイル")]),s._v(" "),a("p",[a("code",[s._v("examples/")]),s._v("配下にある"),a("code",[s._v("example-container.yml")]),s._v("を起動してみます．中身は以下のようになっています．\nこちらの例は複数のコンテナが起動しているDockerネットワークを再現しています．\n二台の仮想ホストとホスト上にブリッジデバイスが定義されていてブリッジを経由して各仮想ホストは疎通ができます．また，NATの設定が定義されているためホスト上のNAT(iptables)を経由してインターネットに接続することができます．")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("example-network-container")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ifaces")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("br0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.50.2/24"')]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ifaces")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host1-veth1-br"')]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host2-veth1-br"')]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host-veth1-br"')]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host-veth1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"veth"')]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.50.1/24"')]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("peer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host-veth1-br"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.50.0/24"')]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("out_iface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eth0"')]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("netns")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ifaces")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host1-veth1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"veth"')]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.50.100/24"')]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("peer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host1-veth1-br"')]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("routes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("route")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gateway")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.50.1"')]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ifaces")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host2-veth1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"veth"')]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.50.101/24"')]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("peer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host2-veth1-br"')]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("routes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("route")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gateway")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.50.1"')]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("h3",{attrs:{id:"仮想ネットワークの作成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#仮想ネットワークの作成"}},[s._v("#")]),s._v(" 仮想ネットワークの作成")]),s._v(" "),a("p",[s._v("実際に実行して仮想ネットワークを作成してみます．\n作成には"),a("code",[s._v("run")]),s._v("コマンドを使用します．")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("root@ubuntu2004:/home/vagrant# pyns2 run pyns2/examples/example-container.yml\n[info] Created Network Namespace host1\n[info] register netns id host1\n[info] Created Network Namespace host2\n[info] register netns id host2\n[info] create bridge interface name=br0\n[info] create veth interface name=host-veth1\n[info] create veth interface name=host1-veth1\n[info] create veth interface name=host2-veth1\n[info] create NAT setting\n[info] host1-veth1 is set netns=host1\n[info] host2-veth1 is set netns=host2\n[info] set address=192.168.50.2/24 to br0\n[info] set address=192.168.50.1/24 to host-veth1\n[info] set address=192.168.50.100/24 to host1-veth1\n[info] set address=192.168.50.101/24 to host2-veth1\n[info] Network Interface(host-veth1) is Up\n[info] Network Interface(host1-veth1) is Up\n[info] Network Interface(host2-veth1) is Up\n[info] dest=default gateway=192.168.50.1 in ns=host1\n[info] dest=default gateway=192.168.50.1 in ns=host2\nroot@ubuntu2004:/home/vagrant#\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("h3",{attrs:{id:"疎通確認"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#疎通確認"}},[s._v("#")]),s._v(" 疎通確認")]),s._v(" "),a("p",[s._v("作成した各ホストの疎通を確認してみます．")]),s._v(" "),a("h4",{attrs:{id:"host-192-168-50-1-host1-192-168-50-100"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#host-192-168-50-1-host1-192-168-50-100"}},[s._v("#")]),s._v(" host(192.168.50.1) -> host1(192.168.50.100)")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("root@ubuntu2004:/home/vagrant# ping 192.168.50.100 -c 3\nPING 192.168.50.100 (192.168.50.100) 56(84) bytes of data.\n64 bytes from 192.168.50.100: icmp_seq=1 ttl=64 time=0.071 ms\n64 bytes from 192.168.50.100: icmp_seq=2 ttl=64 time=0.055 ms\n64 bytes from 192.168.50.100: icmp_seq=3 ttl=64 time=0.053 ms\n\n--- 192.168.50.100 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2048ms\nrtt min/avg/max/mdev = 0.053/0.059/0.071/0.008 ms\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("無事に疎通が取れています．")]),s._v(" "),a("h4",{attrs:{id:"host-192-168-50-1-host2-192-168-50-101"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#host-192-168-50-1-host2-192-168-50-101"}},[s._v("#")]),s._v(" host(192.168.50.1) -> host2(192.168.50.101)")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("root@ubuntu2004:/home/vagrant# ping 192.168.50.101 -c 3\nPING 192.168.50.101 (192.168.50.101) 56(84) bytes of data.\n64 bytes from 192.168.50.101: icmp_seq=1 ttl=64 time=0.093 ms\n64 bytes from 192.168.50.101: icmp_seq=2 ttl=64 time=0.136 ms\n64 bytes from 192.168.50.101: icmp_seq=3 ttl=64 time=0.067 ms\n\n--- 192.168.50.101 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2034ms\nrtt min/avg/max/mdev = 0.067/0.098/0.136/0.028 ms\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("こちらも疎通できているようです．")]),s._v(" "),a("h4",{attrs:{id:"host1-192-168-50-100-host2-192-168-50-101"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#host1-192-168-50-100-host2-192-168-50-101"}},[s._v("#")]),s._v(" host1(192.168.50.100) <-> host2(192.168.50.101)")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("root@ubuntu2004:/home/vagrant# pyns2 exec host1\nroot@ubuntu2004:/home/vagrant# ping 192.168.50.101 -c 3\nPING 192.168.50.101 (192.168.50.101) 56(84) bytes of data.\n64 bytes from 192.168.50.101: icmp_seq=1 ttl=64 time=0.048 ms\n64 bytes from 192.168.50.101: icmp_seq=2 ttl=64 time=0.045 ms\n64 bytes from 192.168.50.101: icmp_seq=3 ttl=64 time=0.038 ms\n\n--- 192.168.50.101 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2035ms\nrtt min/avg/max/mdev = 0.038/0.043/0.048/0.004 ms\nroot@ubuntu2004:/home/vagrant# exit\nroot@ubuntu2004:/home/vagrant# ping 192.168.50.100 -c 3\nPING 192.168.50.100 (192.168.50.100) 56(84) bytes of data.\n64 bytes from 192.168.50.100: icmp_seq=1 ttl=64 time=0.038 ms\n64 bytes from 192.168.50.100: icmp_seq=2 ttl=64 time=0.047 ms\n64 bytes from 192.168.50.100: icmp_seq=3 ttl=64 time=0.043 ms\n\n--- 192.168.50.100 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2040ms\nrtt min/avg/max/mdev = 0.038/0.042/0.047/0.003 ms\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[a("code",[s._v("pyns2 exec")]),s._v("コマンドで"),a("code",[s._v("host1")]),s._v(", "),a("code",[s._v("host2")]),s._v("の名前空間に入り"),a("code",[s._v("ping")]),s._v("を飛ばしてみるとこちらも疎通が取れています．")]),s._v(" "),a("h4",{attrs:{id:"host1-192-168-50-100-internet-8-8-8-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#host1-192-168-50-100-internet-8-8-8-8"}},[s._v("#")]),s._v(" host1(192.168.50.100) -> internet(8.8.8.8)")]),s._v(" "),a("p",[s._v("最後にインターネットと仮想ホストとの疎通を確認します．")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("root@ubuntu2004:/home/vagrant# pyns2 exec host1\nroot@ubuntu2004:/home/vagrant# pyns2 check_netns\nhost1\nroot@ubuntu2004:/home/vagrant# ping 8.8.8.8 -c 3\nPING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.\n64 bytes from 8.8.8.8: icmp_seq=1 ttl=61 time=18.5 ms\n64 bytes from 8.8.8.8: icmp_seq=2 ttl=61 time=19.4 ms\n64 bytes from 8.8.8.8: icmp_seq=3 ttl=61 time=17.3 ms\n\n--- 8.8.8.8 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 2004ms\nrtt min/avg/max/mdev = 17.332/18.391/19.374/0.835 ms\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("無事インターネットと疎通できています．")]),s._v(" "),a("h4",{attrs:{id:"仮想ネットワークの削除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#仮想ネットワークの削除"}},[s._v("#")]),s._v(" 仮想ネットワークの削除")]),s._v(" "),a("p",[s._v("実験が終わったら作成したネットワークを削除します．\n削除には"),a("code",[s._v("pyns2 delete")]),s._v("コマンドを使用します．")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("root@ubuntu2004:/home/vagrant# pyns2 delete pyns2/examples/example-container.yml\n[INFO] Delete interface br0 in host namespace\n[INFO] Delete interface host-veth1 in host namespace\n[info] delete NAT setting\n[INFO] Delete netns host1\n[INFO] Delete netns host2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("これで無事に削除されました．")]),s._v(" "),a("p",[a("code",[s._v("examples/")]),s._v("配下にいくつかネットワークの例を作成しているので是非試してみてください．")]),s._v(" "),a("h2",{attrs:{id:"まとめ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#まとめ"}},[s._v("#")]),s._v(" まとめ")]),s._v(" "),a("p",[s._v("今回は趣味で開発しているネットワークシミュレーションツールを紹介しました．\n作成したネットワーク上でLinuxコマンドを使用できるのでネットワークの学習にも役に立つのではないかなと思います．\n簡単に使えるように"),a("code",[s._v("Vagrantfile")]),s._v("や"),a("code",[s._v("Dockerfile")]),s._v("を用意しているので是非遊んでみてください．\n今後はまだ未実装のインターフェースタイプへの対応やネットワークプロトコルのシミュレーションに対応していきたいと考えています．\nバグ報告(たくさんある)や面白いネットワーク例の追加などあれば是非お知らせください．")])])}),[],!1,null,null,null);t.default=e.exports}}]);